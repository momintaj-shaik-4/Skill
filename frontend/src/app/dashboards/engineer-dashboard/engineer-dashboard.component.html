<div class="flex h-screen bg-slate-100 font-sans text-slate-800">
    <aside class="w-64 bg-slate-900 text-slate-300 flex flex-col shadow-2xl z-20 overflow-hidden">
        <div class="px-6 py-4 text-center border-b border-slate-700/50">
            <div class="relative inline-block mb-4">
                <div class="w-20 h-20 bg-slate-700 rounded-full flex items-center justify-center shadow-lg ring-4 ring-slate-800">
                    <i class="fa-solid fa-user text-slate-400 text-3xl"></i>
                </div>
                <div class="absolute top-0 right-0 w-6 h-6 bg-green-400 rounded-full border-4 border-slate-900"></div>
            </div>
            <h3 class="text-white text-xl font-semibold mb-1">{{ userName }}</h3>
            <p class="text-slate-400 text-sm">Team Member</p>
        </div>

        <nav class="flex-1 px-4 py-3 space-y-1 pb-4">
            <button (click)="selectTab('dashboard')"
                class="w-full text-left px-4 py-2 rounded-lg flex items-center gap-4 transition-all duration-200" [ngClass]="{
        'bg-slate-800/80 text-white border-l-4 border-sky-400 px-3': activeTab === 'dashboard',
        'hover:bg-slate-800/50 hover:text-white': activeTab !== 'dashboard'
      }">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white bg-gradient-to-br from-sky-500 to-cyan-400 shadow-md">
                    <i class="fa-solid fa-chart-pie"></i>
                </div>
                <span class="font-medium">Dashboard</span>
            </button>

            <button (click)="selectTab('mySkills')"
                class="w-full text-left px-4 py-2 rounded-lg flex items-center gap-4 transition-all duration-200" [ngClass]="{
        'bg-slate-800/80 text-white border-l-4 border-sky-400 px-3': activeTab === 'mySkills',
        'hover:bg-slate-800/50 hover:text-white': activeTab !== 'mySkills'
      }">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white bg-gradient-to-br from-violet-500 to-purple-500 shadow-md">
                    <i class="fa-solid fa-graduation-cap"></i>
                </div>
                <span class="font-medium">My Skills</span>
            </button>

            <button (click)="selectTab('trainingCatalog')"
                class="w-full text-left px-4 py-2 rounded-lg flex items-center gap-4 transition-all duration-200" [ngClass]="{
        'bg-slate-800/80 text-white border-l-4 border-sky-400 px-3': activeTab === 'trainingCatalog',
        'hover:bg-slate-800/50 hover:text-white': activeTab !== 'trainingCatalog'
      }">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white bg-gradient-to-br from-emerald-500 to-green-400 shadow-md">
                    <i class="fa-solid fa-book-open"></i>
                </div>
                <span class="font-medium">Training Catalog</span>
            </button>

            <button (click)="selectTab('assignedTrainings')"
                class="w-full text-left px-4 py-2 rounded-lg flex items-center gap-4 transition-all duration-200" [ngClass]="{
        'bg-slate-800/80 text-white border-l-4 border-sky-400 px-3': activeTab === 'assignedTrainings',
        'hover:bg-slate-800/50 hover:text-white': activeTab !== 'assignedTrainings'
      }">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white bg-gradient-to-br from-amber-500 to-yellow-400 shadow-md">
                    <i class="fa-solid fa-paperclip"></i>
                </div>
                <span class="font-medium">Assigned Trainings</span>
            </button>

            <button (click)="selectTab('myBadges')"
                class="w-full text-left px-4 py-2 rounded-lg flex items-center gap-4 transition-all duration-200" [ngClass]="{
        'bg-slate-800/80 text-white border-l-4 border-sky-400 px-3': activeTab === 'myBadges',
        'hover:bg-slate-800/50 hover:text-white': activeTab !== 'myBadges'
      }">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white bg-gradient-to-br from-orange-500 to-amber-400 shadow-md">
                    <i class="fa-solid fa-award"></i>
                </div>
                <span class="font-medium">My Badges</span>
            </button>

            <button (click)="selectTab('levels')"
                class="w-full text-left px-4 py-3 rounded-lg flex items-center gap-4 transition-all duration-200" [ngClass]="{
        'bg-slate-800/80 text-white border-l-4 border-sky-400 px-3': activeTab === 'levels',
        'hover:bg-slate-800/50 hover:text-white': activeTab !== 'levels'
      }">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white bg-gradient-to-br from-indigo-500 to-blue-500 shadow-md">
                    <i class="fa-solid fa-layer-group"></i>
                </div>
                <span class="font-medium">Levels</span>
            </button>

            <button *ngIf="isTrainer" (click)="selectTab('trainerZone')"
                class="w-full text-left px-4 py-3 rounded-lg flex items-center gap-4 transition-all duration-200" [ngClass]="{
        'bg-slate-800/80 text-white border-l-4 border-sky-400 px-3': activeTab === 'trainerZone',
        'hover:bg-slate-800/50 hover:text-white': activeTab !== 'trainerZone'
      }">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white bg-gradient-to-br from-teal-500 to-cyan-500 shadow-md">
                    <i class="fa-solid fa-chalkboard-user"></i>
                </div>
                <span class="font-medium">Trainer Zone</span>
            </button>
        </nav>
    </aside>

    <div class="flex-1 flex flex-col">
        <header class="flex justify-between items-center bg-white/80 backdrop-blur-sm px-8 py-3 border-b border-slate-200/60 sticky top-0 z-10">
            <div class="flex items-center gap-4">
                <h1 class="text-xl font-bold text-slate-800">Engineer Competency Dashboard</h1>
            </div>
            <div class="flex items-center gap-6">
                <span class="text-slate-600 text-sm">Welcome, <span class="font-bold text-slate-900">{{ employeeName }}</span> ({{ employeeId }})</span>
                <button (click)="logout()" class="bg-slate-700 text-white px-4 py-2 rounded-full font-semibold hover:bg-slate-800 transition-colors duration-200 shadow-sm text-sm">
                    <i class="fa-solid fa-right-from-bracket mr-2"></i>Logout
                </button>
            </div>
        </header>


        <main class="flex-1 p-6 overflow-y-auto bg-gradient-to-br from-sky-100 to-cyan-500">
            <div *ngIf="isLoading" class="flex justify-center items-center h-full text-slate-500">
                <svg class="animate-spin -ml-1 mr-3 h-10 w-10 text-sky-600" xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                    </path>
                </svg>
                <span class="text-lg">Loading your data...</span>
            </div>

            <div *ngIf="errorMessage" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg" role="alert">
                <strong class="font-bold">Error!</strong>
                <span class="block sm:inline ml-2">{{ errorMessage }}</span>
            </div>

            <div *ngIf="!isLoading && activeTab === 'dashboard'" @slideFadeIn class="space-y-4">
                 <div @bouncyScale class="flex justify-between items-center bg-gradient-to-r from-slate-800 to-slate-900 text-white px-5 py-2.5 rounded-2xl shadow-lg backdrop-blur-sm border border-white/10">
                     <div class="flex items-center gap-4">
                         <h2 class="text-lg font-bold tracking-tight">Welcome, {{ employeeName }}!</h2>
                         <div class="w-px h-5 bg-white/20"></div>
                         <p class="text-slate-300/90 text-sm hidden lg:block">Here's your competency summary.</p>
                     </div>
                      <div class="flex items-center gap-2">
                         <button (click)="openSkillsModal('all')" class="bg-white/10 px-3 py-1.5 rounded-lg text-center ring-1 ring-white/15 transition-colors duration-200 hover:bg-white/20 flex items-center gap-2">
                              <span class="text-xl font-bold">{{ totalSkills }}</span>
                              <span class="text-[11px] text-slate-200 leading-tight">Total<br>Skills</span>
                         </button>
                         <button (click)="openSkillsModal('Met')" class="bg-white/10 px-3 py-1.5 rounded-lg text-center ring-1 ring-white/15 transition-colors duration-200 hover:bg-white/20 flex items-center gap-2">
                               <span class="text-xl font-bold">{{ skillsMet }}</span>
                               <span class="text-[11px] text-slate-200 leading-tight">Skills<br>Met</span>
                         </button>
                      </div>
                 </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-4">
                        <div @slideFadeIn class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-4">
                            <h3 class="text-base font-bold text-slate-900 mb-2">Core Technical Skills</h3>
                            <div class="grid grid-cols-3 sm:grid-cols-5 gap-2" [@listStagger]="sections.length">
                                <div *ngFor="let section of sections" class="group flex flex-col items-center p-1.5 bg-slate-50/70 hover:bg-white rounded-xl transition-all duration-300 text-center border-2 border-transparent hover:border-sky-400 hover:shadow-md">
                                    <div class="w-8 h-8 mb-1 rounded-full flex items-center justify-center bg-gradient-to-br from-sky-100 to-sky-50 group-hover:scale-110 transition-transform">
                                        <i [ngClass]="getTrainingCardIcon(section.title)" class="text-sky-600"></i>
                                    </div>
                                    <div class="font-semibold text-slate-800 text-[11px] leading-tight">{{ section.title }}</div>
                                </div>
                            </div>
                        </div>
                        <div @slideFadeIn class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-4">
                            <h3 class="text-base font-bold text-slate-900 mb-2">Quick Actions</h3>
                            <div class="grid grid-cols-2 gap-2">
                                <button (click)="selectTab('mySkills')" class="group flex items-center p-2 bg-slate-50/70 hover:bg-white rounded-xl transition-all duration-300 border-2 border-transparent hover:border-sky-400 hover:shadow-md">
                                    <div class="w-8 h-8 mr-2 rounded-lg flex items-center justify-center bg-gradient-to-br from-sky-100 to-sky-50"><i class="fa-solid fa-list-check text-sky-600"></i></div>
                                    <div><div class="font-bold text-slate-900 text-left text-xs">My Skills</div></div>
                                </button>
                                <button (click)="selectTab('trainingCatalog')" class="group flex items-center p-2 bg-slate-50/70 hover:bg-white rounded-xl transition-all duration-300 border-2 border-transparent hover:border-sky-400 hover:shadow-md">
                                    <div class="w-8 h-8 mr-2 rounded-lg flex items-center justify-center bg-gradient-to-br from-sky-100 to-sky-50"><i class="fa-solid fa-book-open text-sky-600"></i></div>
                                    <div><div class="font-bold text-slate-900 text-left text-xs">Catalog</div></div>
                                </button>
                                <button (click)="selectTab('levels')" class="group flex items-center p-2 bg-slate-50/70 hover:bg-white rounded-xl transition-all duration-300 border-2 border-transparent hover:border-sky-400 hover:shadow-md">
                                    <div class="w-8 h-8 mr-2 rounded-lg flex items-center justify-center bg-gradient-to-br from-sky-100 to-sky-50"><i class="fa-solid fa-layer-group text-sky-600"></i></div>
                                    <div><div class="font-bold text-slate-900 text-left text-xs">Levels</div></div>
                                </button>
                                <button (click)="selectTab('myBadges')" class="group flex items-center p-2 bg-slate-50/70 hover:bg-white rounded-xl transition-all duration-300 border-2 border-transparent hover:border-sky-400 hover:shadow-md">
                                    <div class="w-8 h-8 mr-2 rounded-lg flex items-center justify-center bg-gradient-to-br from-sky-100 to-sky-50"><i class="fa-solid fa-award text-sky-600"></i></div>
                                    <div><div class="font-bold text-slate-900 text-left text-xs">My Badges</div></div>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div @bouncyScale class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-4 flex flex-col items-center text-center">
                                <h3 class="text-base font-bold text-slate-900 mb-1">Overall Progress</h3>
                                <div class="relative w-24 h-24 my-1">
                                    <svg class="w-full h-full transform -rotate-90" viewBox="0 0 120 120">
                                        <circle cx="60" cy="60" r="54" stroke-width="10" fill="none" class="stroke-slate-200/70" />
                                        <circle cx="60" cy="60" r="54" stroke-width="10" fill="none" [attr.stroke]="progressPercentage >= 100 ? '#10b981' : '#0ea5e9'" [attr.stroke-dasharray]="339.29" [attr.stroke-dashoffset]="339.29 - (339.29 * progressPercentage / 100)" class="transition-all duration-1000 ease-out" stroke-linecap="round"></circle>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <div class="text-center"><div class="text-xl font-extrabold text-slate-900">{{ progressPercentage }}%</div><p class="text-[10px] text-slate-500 font-medium">Complete</p></div>
                                    </div>
                                </div>
                                <div class="w-full text-xs">
                                    <div class="flex justify-between items-center mb-1 font-medium"><span class="text-slate-900">Progress</span><span class="text-slate-500">{{ skillsMet }} of {{ totalSkills }} skills</span></div>
                                    <div class="bg-slate-200/70 h-2 rounded-full overflow-hidden"><div class="h-full rounded-full transition-all duration-500 ease-out" [ngClass]="getProgressBarClass()" [style.width.%]="progressPercentage"></div></div>
                                </div>
                            </div>
                            <div class="grid grid-rows-3 gap-4">
                                <div @slideFadeIn class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-3 flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-users text-green-600 text-lg"></i></div>
                                    <div><div class="font-semibold text-slate-900 text-sm">Soft Skills</div><div class="font-bold text-lg text-slate-900">{{ getSoftSkillsCount() }}</div></div>
                                </div>
                                <div @slideFadeIn class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-3 flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-crown text-violet-600 text-lg"></i></div>
                                    <div><div class="font-semibold text-slate-900 text-sm">Leadership</div><div class="font-bold text-lg text-slate-900">{{ getLeadershipSkillsCount() }}</div></div>
                                </div>
                                <div @slideFadeIn class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-3 flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-calendar-days text-amber-600 text-lg"></i></div>
                                    <div><div class="font-semibold text-slate-900 text-sm">Trainings</div><div class="font-bold text-lg text-slate-900">{{ dashboardUpcomingTrainings.length }}</div></div>
                                </div>
                            </div>
                        </div>
                        <div @slideFadeIn class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-4">
                            <h3 class="text-base font-bold text-slate-900 mb-2">Upcoming Trainings</h3>
                            <div *ngIf="dashboardUpcomingTrainings.length > 0; else noAssignedTrainings" class="space-y-1.5 max-h-36 overflow-y-auto pr-1">
                                <div *ngFor="let t of dashboardUpcomingTrainings | slice:0:4" class="flex items-center justify-between p-1.5 bg-slate-50/70 rounded-lg border border-slate-200/80 hover:bg-white transition-colors">
                                    <div class="flex items-center gap-2">
                                        <div class="w-8 h-8 bg-sky-100 text-sky-600 rounded-md flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-chalkboard-user"></i></div>
                                        <div>
                                            <div class="font-semibold text-slate-900 text-xs leading-tight">{{ t.training_name }}</div>
                                            <div class="text-[10px] text-slate-500">{{ t.training_date ? (t.training_date | date:'mediumDate') : 'TBD' }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <ng-template #noAssignedTrainings>
                                <div class="text-center py-8 text-slate-500 text-sm">You have no upcoming trainings.</div>
                            </ng-template>
                        </div>
                    </div>
                </div>
            </div>

            <div *ngIf="activeTab !== 'dashboard'">
                <div *ngIf="activeTab === 'mySkills'" @slideFadeIn class="space-y-8">
                <h2 class="text-3xl font-bold text-slate-800">My Skills and Competencies</h2>

                <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-4">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div class="flex items-center gap-3 text-slate-800">
                            <i class="fa-solid fa-filter text-sky-500"></i>
                            <h3 class="text-md font-semibold">Filter Skills</h3>
                        </div>
                        <div class="flex flex-wrap items-center gap-3">
                            <div class="relative">
                                <i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                <input type="text" [(ngModel)]="skillSearch" placeholder="Search..." class="w-full sm:w-40 pl-9 pr-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white/80 transition-all duration-300 focus:w-56">
                            </div>
                            <select [(ngModel)]="skillNameFilter" class="w-full sm:w-auto appearance-none px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white cursor-pointer">
                                <option value="">All Skills</option>
                                <option *ngFor="let name of skillNames" [value]="name">{{ name }}</option>
                            </select>
                            <select [(ngModel)]="skillStatusFilter" class="w-full sm:w-auto appearance-none px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white cursor-pointer">
                                <option value="">All Statuses</option>
                                <option value="Met">Met</option>
                                <option value="Gap">Gap</option>
                                <option value="Error">Error</option>
                            </select>
                            <button (click)="resetSkillFilters()" title="Reset Filters" class="w-9 h-9 flex items-center justify-center text-slate-500 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-colors">
                                <i class="fa-solid fa-rotate-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" [@listStagger]="(getFilteredSkills() | skillFilter:skillSearch:skillStatusFilter).length">
                    <div *ngFor="let competency of getFilteredSkills() | skillFilter:skillSearch:skillStatusFilter"
                        class="relative overflow-hidden bg-white/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-slate-200/60 hover:shadow-xl hover:-translate-y-1 transition-all duration-300"
                        [ngClass]="{
                  'border-t-4 border-green-500': competency.status === 'Met',
                  'border-t-4 border-orange-500': competency.status === 'Gap',
                  'border-t-4 border-red-500': competency.status === 'Error'
                }">
                        <div class="flex flex-col justify-between h-full">
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex items-center space-x-4">
                                    <div
                                        class="w-12 h-12 bg-sky-500 text-white rounded-lg flex items-center justify-center text-xl shadow-md">
                                        <i class="fa-solid fa-graduation-cap"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-extrabold text-xl text-slate-900">{{ competency.skill }}</h3>
                                        <span class="text-sm font-medium text-slate-500">{{ competency.competency || 'Skill' }}</span>
                                    </div>
                                </div>
                                <span class="px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wider" [ngClass]="{
                        'bg-green-100/70 text-green-800': competency.status === 'Met',
                        'bg-orange-100/70 text-orange-800': competency.status === 'Gap',
                        'bg-red-100/70 text-red-800': competency.status === 'Error'
                      }">
                                    {{ competency.status }}
                                </span>
                            </div>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center text-sm">
                                    <div class="flex items-center text-slate-600">
                                        <i class="fa-solid fa-bullseye text-slate-400 mr-2 w-4 text-center"></i>Current: <span
                                            class="ml-1.5 font-semibold text-slate-900">{{ competency.current_expertise }}</span>
                                    </div>
                                    <div class="flex items-center text-slate-600">
                                        <i class="fa-solid fa-rocket text-slate-400 mr-2 w-4 text-center"></i>Target: <span
                                            class="ml-1.5 font-semibold text-slate-900">{{ competency.target_expertise }}</span>
                                    </div>
                                </div>
                                <div class="w-full bg-slate-200/70 rounded-full h-3 overflow-hidden shadow-inner">
                                    <div class="h-full rounded-full transition-all duration-700" [ngClass]="{
                          'bg-gradient-to-r from-green-400 to-emerald-500': competency.status === 'Met',
                          'bg-gradient-to-r from-orange-400 to-amber-500': competency.status === 'Gap',
                          'bg-gradient-to-r from-red-400 to-rose-500': competency.status === 'Error'
                        }" [style.width.%]="getSkillProgress(competency)">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <p *ngIf="(skills | skillFilter:skillSearch:skillStatusFilter).length === 0"
                    class="text-center text-slate-500 mt-8">No skills data available.</p>


                <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-8">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="text-2xl font-bold text-slate-900">Additional Skills Portfolio</h3>
                            <p class="text-sm text-slate-500 mt-1">Personal skills beyond core competencies</p>
                        </div>
                        <button (click)="toggleAddSkillForm()"
                            class="bg-sky-600 hover:bg-sky-700 text-white rounded-full px-4 py-2 transition-all duration-200 flex items-center gap-2 font-medium shadow-sm">
                            <i class="fa-solid fa-plus transition-transform duration-300" [ngClass]="{'rotate-45': showAddSkillForm}"></i><span>{{ showAddSkillForm ? 'Cancel' : 'Add Skill' }}</span>
                        </button>
                    </div>
                    <div *ngIf="showAddSkillForm" @slideFadeIn class="bg-slate-50/70 border border-slate-200/80 rounded-2xl p-6 mb-6">
                        <h4 class="text-xl font-semibold text-slate-900 mb-4">{{ editingSkillId ? 'Edit Skill' : 'Add New Skill' }}</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Skill Name *</label><input type="text"
                                    [(ngModel)]="newSkill.name" placeholder="e.g., Python, Public Speaking"
                                    class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-2">Skill Level</label><select
                                    [(ngModel)]="newSkill.level"
                                    class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none">
                                    <option *ngFor="let level of skillLevels" [value]="level">{{ level }}</option>
                                </select>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 mb-2">Category</label><select
                                    [(ngModel)]="newSkill.category"
                                    class="w-full md:w-1/2 px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none">
                                    <option *ngFor="let category of skillCategories" [value]="category">{{ category }}</option>
                                </select>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 mb-2">Description (Optional)</label><input
                                    type="text" [(ngModel)]="newSkill.description" placeholder="Brief description of your experience"
                                    class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none">
                            </div>
                        </div>
                        <div class="flex items-center justify-end space-x-3 mt-6">
                            <button (click)="toggleAddSkillForm()"
                                class="px-4 py-2 text-slate-600 hover:text-slate-800 font-medium transition-colors duration-200">Cancel</button>
                            <button (click)="addNewSkill()" [disabled]="!newSkill.name.trim()"
                                class="px-4 py-2 bg-sky-600 text-white rounded-lg font-medium hover:bg-sky-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all duration-200">{{ editingSkillId ? 'Update Skill' : 'Add Skill' }}</button>
                        </div>
                    </div>
                    <div *ngIf="additionalSkills.length > 0" class="space-y-3" [@listStagger]="additionalSkills.length">
                        <div *ngFor="let skill of additionalSkills"
                            class="bg-white/70 border border-slate-200/80 rounded-xl p-4 hover:shadow-md hover:border-slate-300 transition-all duration-200 flex items-center justify-between">
                            <div class="flex-1 flex items-center space-x-4">
                                <div class="w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center">
                                    <i class="fa-solid fa-star text-amber-500"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-slate-900">{{ skill.skill_name }}</h4>
                                    <div class="flex items-center space-x-2 mt-1">
                                        <span class="px-2 py-0.5 rounded text-xs font-medium"
                                            [ngClass]="getSkillLevelColor(skill.skill_level)">{{ skill.skill_level }}</span>
                                        <span class="px-2 py-0.5 rounded text-xs font-medium"
                                            [ngClass]="getCategoryColor(skill.skill_category)">{{ skill.skill_category }}</span>
                                    </div>
                                    <p *ngIf="skill.description" class="text-slate-600 text-sm mt-2">{{ skill.description }}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-1">
                                <button (click)="editAdditionalSkill(skill)"
                                    class="w-9 h-9 text-slate-400 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-all duration-200 flex items-center justify-center">
                                    <i class="fa-solid fa-edit text-sm"></i>
                                </button>
                                <button (click)="removeAdditionalSkill(skill.id)"
                                    class="w-9 h-9 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 flex items-center justify-center">
                                    <i class="fa-solid fa-trash text-sm"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="additionalSkills.length === 0 && !showAddSkillForm"
                        class="text-center py-12 bg-slate-50/70 rounded-2xl border-2 border-dashed border-slate-300">
                        <div class="w-12 h-12 bg-slate-200 rounded-lg flex items-center justify-center mx-auto mb-4">
                            <i class="fa-solid fa-plus text-slate-500 text-lg"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-slate-900 mb-2">Build Your Skills Portfolio</h4>
                        <p class="text-slate-600 mb-6 max-w-md mx-auto">Showcase your other talents and expertise that complement your core competencies.</p>
                    </div>
                </div>
            </div>

                <div *ngIf="activeTab === 'trainingCatalog'" @slideFadeIn class="space-y-8">
                    <div>
                        <h2 class="text-3xl font-bold text-slate-800">Training Catalog</h2>
                        <p class="text-slate-500 mt-1">Browse available training sessions to enhance your skills.</p>
                    </div>

                    <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-4">
                        <div class="flex flex-wrap items-center justify-between gap-4">
                            <div class="flex items-center gap-3 text-slate-800">
                                <i class="fa-solid fa-filter text-sky-500"></i>
                                <h3 class="text-md font-semibold">Filter Trainings</h3>
                            </div>
                            <div class="flex flex-wrap items-center gap-3">
                                <div class="relative">
                                    <i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                    <input type="text" [(ngModel)]="trainingSearch" placeholder="Search..." class="w-full sm:w-40 pl-9 pr-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white/80 transition-all duration-300 focus:w-56">
                                </div>
                                <select [(ngModel)]="trainingSkillFilter" class="w-full sm:w-auto appearance-none px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white cursor-pointer">
                                    <option value="All">All Skills</option>
                                    <option *ngFor="let name of skillNames" [value]="name">{{ name }}</option>
                                </select>
                                <select [(ngModel)]="trainingLevelFilter" class="w-full sm:w-auto appearance-none px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white cursor-pointer">
                                    <option value="All">All Levels</option>
                                    <option *ngFor="let level of skillCategoryLevels" [value]="level">{{ level }}</option>
                                </select>
                                <input type="date" [(ngModel)]="trainingDateFilter" class="w-full sm:w-auto px-3 py-1.5 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white">
                                <button (click)="resetTrainingFilters()" title="Reset Filters" class="w-9 h-9 flex items-center justify-center text-slate-500 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-colors">
                                    <i class="fa-solid fa-rotate-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end -mb-2">
                        <div class="inline-flex rounded-lg shadow-sm bg-slate-200/70 p-1">
                            <button (click)="setTrainingCatalogView('list')" class="px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200" [ngClass]="{'bg-white text-sky-600 shadow': trainingCatalogView === 'list', 'text-slate-600 hover:bg-slate-300/50': trainingCatalogView !== 'list'}">
                                <i class="fa-solid fa-list-ul mr-2"></i>List View
                            </button>
                            <button (click)="setTrainingCatalogView('calendar')" class="px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200" [ngClass]="{'bg-white text-sky-600 shadow': trainingCatalogView === 'calendar', 'text-slate-600 hover:bg-slate-300/50': trainingCatalogView !== 'calendar'}">
                                <i class="fa-solid fa-calendar-days mr-2"></i>Calendar View
                            </button>
                        </div>
                    </div>

                    <div *ngIf="trainingCatalogView === 'list'">
                        <div *ngIf="filteredTrainings.length === 0"
                            class="text-center py-20 bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border-2 border-dashed border-slate-300">
                            <div class="w-20 h-20 bg-gradient-to-br from-sky-100 to-sky-200 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fa-solid fa-folder-open text-sky-500 text-4xl"></i>
                            </div>
                            <h4 class="text-2xl font-bold text-slate-800 mb-2">No Trainings Found</h4>
                            <p class="text-slate-600 max-w-md mx-auto">No training sessions match your current filters. Try resetting the filters.</p>
                        </div>

                        <div *ngIf="filteredTrainings.length > 0" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" [@listStagger]="filteredTrainings.length">
                            <div *ngFor="let training of filteredTrainings"
                                class="group bg-white/70 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 overflow-hidden transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out hover:shadow-2xl flex flex-col">
                                <div class="h-2 bg-gradient-to-r from-sky-500 to-cyan-400"></div>
                                <div class="p-6 flex-grow flex flex-col">
                                    <div class="flex items-start gap-4 mb-4">
                                        <div class="flex-shrink-0 w-12 h-12 bg-slate-100 text-sky-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                                            <i [ngClass]="getTrainingCardIcon(training.skill)" class="text-2xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold leading-tight text-slate-800">{{ training.training_name }}</h3>
                                            <p class="text-sm text-slate-500">by {{ training.trainer_name }}</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2 flex-wrap mb-4">
                                        <span class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-sky-100 text-sky-800 ring-1 ring-inset ring-sky-200"><i class="fa-solid fa-display mr-1.5"></i>{{ training.training_type || 'N/A' }}</span>
                                        <span class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-violet-100 text-violet-800 ring-1 ring-inset ring-violet-200"><i class="fa-solid fa-layer-group mr-1.5"></i>{{ training.skill_category || 'N/A' }}</span>
                                        <span class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-rose-100 text-rose-800 ring-1 ring-inset ring-rose-200" *ngIf="training.seats"><i class="fa-solid fa-users mr-1.5"></i>{{ training.seats }} Seats</span>
                                    </div>
                                    <div class="flex-grow text-sm text-slate-600 mb-4">
                                        <p><strong class="font-semibold text-slate-700">Topics:</strong> {{ training.training_topics || 'Not specified' }}</p>
                                    </div>
                                    <div class="pt-4 mt-auto border-t border-slate-200/80 space-y-2 text-sm">
                                        <div class="flex items-center justify-between text-slate-600">
                                            <div class="flex items-center gap-2">
                                                <i class="fa-solid fa-calendar-days text-slate-400 w-4 text-center"></i>
                                                <span class="font-medium text-slate-800">{{ training.training_date ? (training.training_date | date:'mediumDate') : 'Date TBD' }}</span>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <i class="fa-solid fa-clock text-slate-400 w-4 text-center"></i>
                                                <span class="font-medium text-slate-800">{{ training.time || 'Time TBD' }}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pt-4 mt-4 border-t border-slate-200/80">
                                        <button (click)="enrollInTraining(training)" class="w-full bg-sky-600 text-white font-semibold py-2 rounded-lg hover:bg-sky-700 transition-colors duration-200">
                                            <i class="fa-solid fa-user-plus mr-2"></i>Enroll
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div *ngIf="trainingCatalogView === 'calendar'" @fadeIn>
                        <div class="bg-white/80 backdrop-blur-sm p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200/60">
                            <div class="flex justify-between items-center mb-6">
                                <button (click)="previousMonth()" class="w-10 h-10 bg-slate-200/70 rounded-lg hover:bg-slate-300/80 transition-colors flex items-center justify-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </button>
                                <h3 class="text-2xl font-bold text-slate-800">{{ calendarMonth }} {{ calendarYear }}</h3>
                                <button (click)="nextMonth()" class="w-10 h-10 bg-slate-200/70 rounded-lg hover:bg-slate-300/80 transition-colors flex items-center justify-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </button>
                            </div>
                            <div class="grid grid-cols-7 gap-1 sm:gap-2 text-center">
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">SUN</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">MON</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">TUE</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">WED</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">THU</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">FRI</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">SAT</div>
    
                                <div *ngFor="let day of calendarDays" class="relative h-20 sm:h-28 font-semibold rounded-lg transition-colors border border-slate-100/80"
                                     [ngClass]="{
                                       'bg-sky-600 text-white shadow-lg': isToday(day),
                                       'bg-slate-50/50': day && !isToday(day),
                                       'bg-transparent': !day,
                                       'text-slate-400': !day || day.getMonth() !== currentDate.getMonth(),
                                       'bg-white shadow-sm': getEventForDate(day, allTrainingsCalendarEvents) && !isToday(day)
                                     }">
                                    <span *ngIf="day" class="absolute top-1.5 left-2 text-xs sm:text-sm">{{ day.getDate() }}</span>
                                    <div *ngIf="getEventForDate(day, allTrainingsCalendarEvents) as event"
                                         class="absolute inset-1 p-1 sm:p-1.5 text-[10px] sm:text-[11px] bg-sky-500 text-white rounded-md cursor-pointer leading-tight shadow-lg hover:bg-sky-600 flex flex-col justify-center text-center"
                                         [title]="event.title + ' - by ' + event.trainer">
                                        <span class="font-bold truncate">{{ event.title }}</span>
                                        <span class="truncate text-white/80 text-[9px] sm:text-[10px] mt-0.5"><i class="fa-solid fa-chalkboard-user opacity-80 mr-1"></i>{{ event.trainer }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div *ngIf="activeTab === 'assignedTrainings'" @slideFadeIn>
                    <div>
                        <h2 class="text-3xl font-bold text-slate-800">Assigned Trainings</h2>
                        <p class="text-slate-500 mt-1">Trainings assigned to you for skill development.</p>
                    </div>

                    <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-4 my-8">
                        <div class="flex flex-wrap items-center justify-between gap-4">
                            <div class="flex items-center gap-3 text-slate-800">
                                <i class="fa-solid fa-filter text-sky-500"></i>
                                <h3 class="text-md font-semibold">Filter Trainings</h3>
                            </div>
                            <div class="flex flex-wrap items-center gap-3">
                                <div class="relative">
                                    <i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                    <input type="text" [(ngModel)]="assignedSearch" placeholder="Search..." class="w-full sm:w-40 pl-9 pr-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white/80 transition-all duration-300 focus:w-56">
                                </div>
                                <select [(ngModel)]="assignedSkillFilter" class="w-full sm:w-auto appearance-none px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white cursor-pointer">
                                    <option value="All">All Skills</option>
                                    <option *ngFor="let name of skillNames" [value]="name">{{ name }}</option>
                                </select>
                                <select [(ngModel)]="assignedLevelFilter" class="w-full sm:w-auto appearance-none px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white cursor-pointer">
                                    <option value="All">All Levels</option>
                                    <option *ngFor="let level of skillCategoryLevels" [value]="level">{{ level }}</option>
                                </select>
                                <input type="date" [(ngModel)]="assignedDateFilter" class="w-full sm:w-auto px-3 py-1.5 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white">
                                <button (click)="resetAssignedTrainingFilters()" title="Reset Filters" class="w-9 h-9 flex items-center justify-center text-slate-500 hover:text-sky-600 hover:bg-sky-50 rounded-lg transition-colors">
                                    <i class="fa-solid fa-rotate-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end -mb-2">
                        <div class="inline-flex rounded-lg shadow-sm bg-slate-200/70 p-1">
                            <button (click)="setAssignedTrainingsView('list')" class="px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200" [ngClass]="{'bg-white text-sky-600 shadow': assignedTrainingsView === 'list', 'text-slate-600 hover:bg-slate-300/50': assignedTrainingsView !== 'list'}">
                                <i class="fa-solid fa-list-ul mr-2"></i>List View
                            </button>
                            <button (click)="setAssignedTrainingsView('calendar')" class="px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200" [ngClass]="{'bg-white text-sky-600 shadow': assignedTrainingsView === 'calendar', 'text-slate-600 hover:bg-slate-300/50': assignedTrainingsView !== 'calendar'}">
                                <i class="fa-solid fa-calendar-days mr-2"></i>Calendar View
                            </button>
                        </div>
                    </div>
                    
                    <div *ngIf="assignedTrainingsView === 'list'">
                        <div *ngIf="filteredAssignedTrainings && filteredAssignedTrainings.length > 0; else noAssigned" class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8" [@listStagger]="filteredAssignedTrainings.length">
                            <div *ngFor="let t of filteredAssignedTrainings"
                                class="bg-white/70 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-slate-200/60 transform hover:-translate-y-1 transition-all duration-300 hover:shadow-xl flex flex-col gap-4">
                                <div class="flex items-start justify-between">
                                    <div class="flex items-start gap-4">
                                        <div class="w-12 h-12 bg-sky-100 text-sky-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                            <i [ngClass]="getTrainingCardIcon(t.skill)" class="text-2xl"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-bold text-slate-800">{{ t.training_name }}</h3>
                                            <p class="text-sm text-slate-500">by {{ t.trainer_name }}</p>
                                        </div>
                                    </div>
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-amber-100 text-amber-800 ring-1 ring-inset ring-amber-200">
                                        <i class="fa-solid fa-clock mr-1.5"></i> Upcoming
                                    </span>
                                </div>
                                <div class="border-t border-slate-200/80"></div>
                                <div class="flex items-center justify-between text-sm">
                                    <div class="flex items-center gap-2 text-slate-600">
                                        <i class="fa-solid fa-calendar-days text-slate-400"></i>
                                        <span class="font-semibold text-slate-800">{{ t.training_date ? (t.training_date | date:'fullDate') : 'Date To Be Decided' }}</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-slate-600">
                                        <i class="fa-solid fa-clock text-slate-400"></i>
                                        <span class="font-semibold text-slate-800">{{ t.time || 'Time TBD' }}</span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 flex-wrap pt-2">
                                    <span class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-slate-100 text-slate-700 ring-1 ring-inset ring-slate-200"><i class="fa-solid fa-display mr-1.5"></i>{{ t.training_type || 'N/A' }}</span>
                                    <span *ngIf="t.skill_category" class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-slate-100 text-slate-700 ring-1 ring-inset ring-slate-200"><i class="fa-solid fa-layer-group mr-1.5"></i>{{ t.skill_category }}</span>
                                    <span *ngIf="t.skill" class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-slate-100 text-slate-700 ring-1 ring-inset ring-slate-200"><i class="fa-solid fa-code mr-1.5"></i>{{ t.skill }}</span>
                                </div>
                                 <div class="mt-auto pt-4 border-t border-slate-200/80 flex items-center gap-3">
                                    <button (click)="viewAssignment(t)" class="flex-1 bg-violet-600 text-white font-semibold py-2 rounded-lg hover:bg-violet-700 transition-colors duration-200 text-sm">
                                        <i class="fa-solid fa-file-lines mr-1.5"></i>View Assignment
                                    </button>
                                    <button (click)="giveFeedback(t)" class="flex-1 bg-rose-600 text-white font-semibold py-2 rounded-lg hover:bg-rose-700 transition-colors duration-200 text-sm">
                                        <i class="fa-solid fa-comment-dots mr-1.5"></i>Give Feedback
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <ng-template #noAssigned>
                            <div class="text-center py-20 mt-8 bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border-2 border-dashed border-slate-300">
                                <div class="w-20 h-20 bg-gradient-to-br from-slate-100 to-slate-200 rounded-full flex items-center justify-center mx-auto mb-6">
                                    <i class="fa-solid fa-inbox text-slate-400 text-4xl"></i>
                                </div>
                                <h4 class="text-2xl font-bold text-slate-800 mb-2">No Assigned Trainings</h4>
                                <p class="text-slate-600 max-w-md mx-auto">You currently have no assigned trainings, or none match your filters.</p>
                            </div>
                        </ng-template>
                    </div>

                    <div *ngIf="assignedTrainingsView === 'calendar'" @fadeIn class="mt-8">
                        <div class="bg-white/80 backdrop-blur-sm p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200/60">
                            <div class="flex justify-between items-center mb-6">
                                <button (click)="previousMonth()" class="w-10 h-10 bg-slate-200/70 rounded-lg hover:bg-slate-300/80 transition-colors flex items-center justify-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </button>
                                <h3 class="text-2xl font-bold text-slate-800">{{ calendarMonth }} {{ calendarYear }}</h3>
                                <button (click)="nextMonth()" class="w-10 h-10 bg-slate-200/70 rounded-lg hover:bg-slate-300/80 transition-colors flex items-center justify-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </button>
                            </div>
                            <div class="grid grid-cols-7 gap-1 sm:gap-2 text-center">
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">SUN</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">MON</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">TUE</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">WED</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">THU</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">FRI</div>
                                <div class="font-bold text-slate-500 py-2 text-xs sm:text-sm">SAT</div>
    
                                <div *ngFor="let day of calendarDays" class="relative h-20 sm:h-28 font-semibold rounded-lg transition-colors border border-slate-100/80"
                                     [ngClass]="{
                                       'bg-sky-600 text-white shadow-lg': isToday(day),
                                       'bg-slate-50/50': day && !isToday(day),
                                       'bg-transparent': !day,
                                       'text-slate-400': !day || day.getMonth() !== currentDate.getMonth(),
                                       'bg-white shadow-sm': getEventForDate(day, assignedTrainingsCalendarEvents) && !isToday(day)
                                     }">
                                    <span *ngIf="day" class="absolute top-1.5 left-2 text-xs sm:text-sm">{{ day.getDate() }}</span>
                                    <div *ngIf="getEventForDate(day, assignedTrainingsCalendarEvents) as event"
                                         class="absolute inset-1 p-1 sm:p-1.5 text-[10px] sm:text-[11px] bg-rose-500 text-white rounded-md cursor-pointer leading-tight shadow-lg hover:bg-rose-600 flex flex-col justify-center text-center"
                                         [title]="event.title + ' - by ' + event.trainer">
                                        <span class="font-bold truncate">{{ event.title }}</span>
                                        <span class="truncate text-white/80 text-[9px] sm:text-[10px] mt-0.5"><i class="fa-solid fa-chalkboard-user opacity-80 mr-1"></i>{{ event.trainer }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="activeTab === 'myBadges'" @slideFadeIn>
                    <h2 class="text-3xl font-bold mb-8 text-slate-800">My Badges & Achievements</h2>
                    <div *ngIf="badges.length > 0" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8" [@listStagger]="badges.length">
                        <div *ngFor="let badge of badges"
                            class="group flex flex-col items-center text-center p-6 bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 transform transition-all duration-300 hover:-translate-y-2 hover:shadow-xl">
                            <div class="relative w-36 h-36">
                                <div
                                    class="absolute inset-0 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full transform group-hover:scale-110 transition-transform duration-300 shadow-lg">
                                </div>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div class="w-28 h-28 bg-white/30 backdrop-blur-sm rounded-full"></div>
                                </div>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div class="w-24 h-24 bg-white rounded-full shadow-inner">
                                        <i class="fa-solid fa-award text-5xl text-amber-500 group-hover:animate-pulse mt-5"></i>
                                    </div>
                                </div>
                            </div>
                            <h3 class="mt-6 text-xl font-bold text-slate-800">{{ badge.skill }}</h3>
                            <p class="text-sm text-slate-500 mt-1">Competency Met</p>
                            <p class="text-xs text-slate-400 mt-2">Achieved on {{ getFormattedDate() }}</p>
                        </div>
                    </div>
                    <div *ngIf="badges.length === 0"
                        class="text-center py-12 bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60">
                        <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fa-solid fa-award text-slate-400 text-3xl"></i>
                        </div>
                        <h4 class="text-xl font-semibold text-slate-900 mb-2">No Badges Earned Yet</h4>
                        <p class="text-slate-600">Keep learning and meeting your skill targets to earn badges!</p>
                    </div>
                </div>

                <div *ngIf="activeTab === 'levels'" @slideFadeIn>
                    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6">
                        <h2 class="text-3xl font-bold text-slate-800">Levels Definitions</h2>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <div class="relative">
                                <select [(ngModel)]="selectedSkill" (ngModelChange)="onSkillChange()"
                                    class="w-full sm:w-64 appearance-none px-4 py-2.5 rounded-xl border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white/80 cursor-pointer pr-12">
                                    <option value="">All Skills</option>
                                    <option *ngFor="let section of sections" [value]="section.title">{{ section.title }}</option>
                                </select>
                                <div class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none">
                                    <i class="fa-solid fa-chevron-down text-slate-500 text-xs"></i>
                                </div>
                            </div>
                            <input [(ngModel)]="levelsSearch" type="text" placeholder="Search levels, keywords..."
                                class="w-full sm:w-80 px-4 py-2 rounded-xl border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white/80" />
                        </div>
                    </div>
                    <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 overflow-hidden">
                        <div *ngIf="getFilteredSections().length === 0" class="p-8 text-center text-slate-500">
                            <i class="fa-solid fa-search text-4xl mb-4"></i>
                            <p>No skills found matching your criteria.</p>
                        </div>
                        <div *ngFor="let section of getFilteredSections()" class="border-b border-slate-200/60 last:border-b-0">
                            <div class="bg-slate-50/70 px-6 py-4 border-b border-slate-200/60">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h3 class="text-xl font-bold text-slate-900">{{ section.title }}</h3>
                                        <p *ngIf="section.subtitle" class="text-sm text-slate-600 mt-1">{{ section.subtitle }}</p>
                                    </div>
                                    <div class="text-sm text-slate-500">{{ section.levels.length }} Levels</div>
                                </div>
                            </div>
                            <div class="p-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-5" [@listStagger]="section.levels.length">
                                    <div *ngFor="let lvl of section.levels; let i = index"
                                        class="bg-slate-50/70 rounded-xl border border-slate-200/80 hover:shadow-md hover:border-slate-300 transition-all duration-300 overflow-hidden">
                                        <div class="px-4 py-3 border-b border-slate-200/80" [ngClass]="getLevelHeaderClass(lvl.level)">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center space-x-2">
                                                    <div class="w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-sm"
                                                        [ngClass]="getLevelBadgeClass(lvl.level)">L{{ lvl.level }}</div>
                                                    <div>
                                                        <p class="font-bold text-sm" [class.text-sky-700]="lvl.level > 0">{{ getLevelTitle(lvl.level) }}</p>
                                                    </div>
                                                </div>
                                                <i class="text-lg" [ngClass]="getLevelIcon(lvl.level)"></i>
                                            </div>
                                        </div>
                                        <div class="p-4">
                                            <div class="space-y-2 max-h-40 overflow-y-auto pr-2">
                                                <div *ngFor="let item of lvl.items" class="flex items-start space-x-2.5 text-xs">
                                                    <div class="w-1.5 h-1.5 rounded-full bg-sky-400 mt-1 flex-shrink-0"></div>
                                                    <span class="text-slate-700 leading-relaxed">{{ item }}</span>
                                                </div>
                                            </div>
                                            <div class="mt-4 pt-3 border-t border-slate-200/80">
                                                <div class="flex items-center justify-between">
                                                    <span class="text-xs text-slate-500 font-medium">Complexity</span>
                                                    <div class="flex space-x-1">
                                                        <div *ngFor="let dot of getComplexityDots(lvl.level)" class="w-2 h-2 rounded-full"
                                                            [ngClass]="dot ? 'bg-sky-500' : 'bg-slate-300'"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="activeTab === 'trainerZone' && isTrainer" @slideFadeIn>
                    <div *ngIf="trainerZoneView === 'overview'" @fadeIn>
                        <h2 class="text-3xl font-bold text-slate-800 mb-6">Trainer Zone</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div class="relative bg-gradient-to-br from-sky-500 to-blue-600 rounded-2xl p-8 text-white shadow-xl overflow-hidden transform transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl flex flex-col">
                                <i class="fa-solid fa-calendar-plus absolute -right-4 -bottom-4 text-blue-900/20 text-[120px] transform rotate-[-15deg]"></i>
                                <div class="relative z-10 flex flex-col h-full">
                                    <h3 class="text-2xl font-bold mb-2">Schedule Training</h3>
                                    <p class="text-sky-100 text-sm mb-6">Create and publish new training sessions for the team.</p>
                                    <div class="mt-auto">
                                        <button (click)="openScheduleTrainingModal()" class="w-full bg-white text-sky-600 font-bold px-6 py-3 rounded-lg hover:bg-sky-100 hover:shadow-lg transition-all duration-200 transform hover:scale-105">
                                            <i class="fa-solid fa-plus-circle mr-2"></i>Schedule New Training
                                        </button>
                                    </div>
                                </div>
                            </div>
                
                            <div class="relative bg-gradient-to-br from-indigo-500 to-violet-500 rounded-2xl p-8 text-white shadow-xl overflow-hidden transform transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl flex flex-col">
                                <i class="fa-solid fa-file-alt absolute -right-4 -bottom-4 text-violet-800/20 text-[120px] transform rotate-[-15deg]"></i>
                                <div class="relative z-10 flex flex-col h-full">
                                    <h3 class="text-2xl font-bold mb-2">Assignments</h3>
                                    <p class="text-violet-100 text-sm mb-6">Create and distribute assignments for a training.</p>
                                    <div class="mt-auto">
                                        <button (click)="setTrainerZoneView('assignmentForm')" class="w-full bg-white text-indigo-600 font-bold px-6 py-3 rounded-lg hover:bg-violet-100 hover:shadow-lg transition-all duration-200 transform hover:scale-105">
                                            <i class="fa-solid fa-plus-circle mr-2"></i>Create Assignment
                                        </button>
                                    </div>
                                </div>
                            </div>
                
                            <div class="relative bg-gradient-to-br from-yellow-500 to-amber-500 rounded-2xl p-8 text-white shadow-xl overflow-hidden transform transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl flex flex-col">
                                <i class="fa-solid fa-comments absolute -right-4 -bottom-4 text-amber-800/20 text-[120px] transform rotate-[-15deg]"></i>
                                <div class="relative z-10 flex flex-col h-full">
                                    <h3 class="text-2xl font-bold mb-2">Feedback Questions</h3>
                                    <p class="text-amber-100 text-sm mb-6">Create a set of questions to gather feedback on a training.</p>
                                    <div class="mt-auto">
                                        <button (click)="setTrainerZoneView('feedbackForm')" class="w-full bg-white text-yellow-600 font-bold px-6 py-3 rounded-lg hover:bg-yellow-100 hover:shadow-lg transition-all duration-200 transform hover:scale-105">
                                            <i class="fa-solid fa-plus-circle mr-2"></i>Create Feedback Form
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div *ngIf="trainerZoneView === 'assignmentForm'" @fadeIn class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-8">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-2xl font-bold text-slate-900">Create New Assignment</h3>
                            <button (click)="setTrainerZoneView('overview')" class="bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-full px-4 py-2 transition-all duration-200 flex items-center gap-2 font-medium">
                                <i class="fa-solid fa-arrow-left"></i><span>Back to Overview</span>
                            </button>
                        </div>
                        <div class="bg-slate-50/70 border border-slate-200/80 rounded-2xl p-6">
                            <div class="space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-2">Training Name *</label>
                                        <select [(ngModel)]="newAssignment.trainingId" name="assignmentTraining" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                                            <option [ngValue]="null">Select a Training</option>
                                            <option *ngFor="let t of allTrainings" [value]="t.id">{{ t.training_name }}</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-2">Assignment Title *</label>
                                        <input type="text" [(ngModel)]="newAssignment.title" name="assignmentTitle" required placeholder="e.g., Softcar Fundamentals Quiz" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-2">General Instructions (Optional)</label>
                                    <textarea [(ngModel)]="newAssignment.description" name="assignmentDescription" rows="2" placeholder="Provide overall instructions for the assignment..." class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition"></textarea>
                                </div>
                        
                                <div class="pt-4 border-t border-slate-300/80">
                                    <h5 class="text-lg font-semibold text-slate-800 mb-3">Assignment Questions</h5>
                                    <div class="space-y-5">
                                        <div *ngFor="let question of newAssignment.questions; let qIndex = index; trackBy: trackByFn" @slideFadeIn
                                             class="bg-white border border-slate-300/90 rounded-xl p-4 space-y-3 relative shadow-sm">
                                            
                                            <div class="flex items-start gap-3">
                                                <span class="font-bold text-lg text-slate-500 pt-1.5">{{ qIndex + 1 }}.</span>
                                                <div class="flex-grow space-y-2">
                                                     <label class="text-sm font-medium text-slate-700">Question Text *</label>
                                                     <input type="text" [(ngModel)]="question.text" [name]="'q_text_' + qIndex" placeholder="e.g., What is the main goal of a Softcar simulation?" class="w-full px-3 py-2 text-md bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                                                </div>
                                                <select [(ngModel)]="question.type" [name]="'q_type_' + qIndex" (change)="onQuestionTypeChange(question)" class="px-3 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 outline-none bg-white">
                                                    <option value="single-choice">Single Choice</option>
                                                    <option value="multiple-choice">Multiple Choice</option>
                                                    <option value="text-input">Text Input</option>
                                                </select>
                                            </div>
                                            
                                            <div class="pl-8">
                                                 <label class="text-xs font-medium text-slate-500">Helper Text (Optional)</label>
                                                 <input type="text" [(ngModel)]="question.helperText" [name]="'q_helper_' + qIndex" placeholder="e.g., Please select at most 2 options." class="w-full px-3 py-1.5 text-sm bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                                            </div>
                        
                                            <div *ngIf="question.type === 'single-choice' || question.type === 'multiple-choice'" @fadeIn class="pl-8 pt-2 space-y-2">
                                                 <label class="text-sm font-medium text-slate-700">Options (Mark correct answer/s)</label>
                                                <div *ngFor="let option of question.options; let oIndex = index; trackBy: trackByFn" @fadeIn class="flex items-center gap-3">
                                                    <input *ngIf="question.type === 'single-choice'" type="radio" [name]="'correct_opt_' + qIndex" [checked]="option.isCorrect" (click)="toggleCorrectOption(qIndex, oIndex)" class="h-5 w-5 text-sky-600 focus:ring-sky-500 cursor-pointer" title="Mark as correct answer">
                                                    <input *ngIf="question.type === 'multiple-choice'" type="checkbox" [(ngModel)]="option.isCorrect" [name]="'q' + qIndex + '_iscorrect' + oIndex" class="h-5 w-5 rounded text-sky-600 focus:ring-sky-500 cursor-pointer" title="Mark as a correct answer">
                        
                                                    <input type="text" [(ngModel)]="option.text" [name]="'q' + qIndex + '_opt' + oIndex" placeholder="Option {{ oIndex + 1 }}" class="flex-grow px-3 py-1.5 text-sm bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                                                    <button type="button" (click)="removeOptionFromQuestion(qIndex, oIndex)" class="w-8 h-8 flex-shrink-0 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 flex items-center justify-center" title="Remove Option">
                                                        <i class="fa-solid fa-trash-alt text-sm"></i>
                                                    </button>
                                                </div>
                                                <button type="button" (click)="addOptionToQuestion(qIndex)" class="text-sm font-medium text-sky-600 hover:text-sky-800 transition-colors duration-200 mt-2">
                                                    <i class="fa-solid fa-plus mr-1"></i> Add Another Option
                                                </button>
                                            </div>
                        
                                            <button type="button" (click)="removeAssignmentQuestion(qIndex)" class="absolute -top-2 -right-2 w-7 h-7 bg-slate-600 text-white rounded-full hover:bg-red-600 transition-all shadow flex items-center justify-center" title="Delete This Question">
                                                <i class="fa-solid fa-times text-xs"></i>
                                            </button>
                                        </div>
                        
                                        <div *ngIf="newAssignment.questions.length === 0" class="text-center py-8 text-slate-500 border-2 border-dashed border-slate-300 rounded-lg">
                                            <i class="fa-solid fa-file-circle-question text-3xl text-slate-400 mb-2"></i>
                                            <p>No questions yet. Click below to build your assignment.</p>
                                        </div>
                                    </div>
                        
                                    <button type="button" (click)="addAssignmentQuestion()" class="w-full mt-4 text-center py-2.5 text-md font-semibold text-sky-700 bg-sky-50 hover:bg-sky-100 border-2 border-dashed border-sky-300 rounded-lg transition-colors duration-200">
                                        <i class="fa-solid fa-plus-circle mr-2"></i> Add a New Question
                                    </button>
                                </div>
                            </div>
                        
                            <div class="flex items-center justify-end space-x-3 mt-8 pt-4 border-t border-slate-300/80">
                                <button (click)="setTrainerZoneView('overview')" class="px-5 py-2 text-slate-700 bg-slate-200 hover:bg-slate-300 font-semibold rounded-lg transition-colors duration-200">Cancel</button>
                                <button (click)="submitAssignment()" class="px-5 py-2 bg-violet-600 text-white rounded-lg font-semibold hover:bg-violet-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all duration-200 shadow-md">
                                   <i class="fa-solid fa-paper-plane mr-2"></i> Create and Share Assignment
                                </button>
                            </div>
                        </div>
                    </div>
                
                    <div *ngIf="trainerZoneView === 'feedbackForm'" @fadeIn class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-slate-200/60 p-8">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-2xl font-bold text-slate-900">New Feedback Form</h3>
                            <button (click)="setTrainerZoneView('overview')" class="bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-full px-4 py-2 transition-all duration-200 flex items-center gap-2 font-medium">
                                <i class="fa-solid fa-arrow-left"></i><span>Back to Overview</span>
                            </button>
                        </div>
                        <div class="bg-slate-50/70 border border-slate-200/80 rounded-2xl p-6">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-2">Training Name *</label>
                                    <select [(ngModel)]="newFeedback.trainingId" name="feedbackTraining" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                                        <option [ngValue]="null">Select a Training</option>
                                        <option *ngFor="let t of allTrainings" [value]="t.id">{{ t.training_name }}</option>
                                    </select>
                                </div>

                                <div>
                                    <h5 class="text-md font-semibold text-slate-800 pt-3 border-t border-slate-200/80">Default Questions</h5>
                                    <div class="space-y-3 mt-2">
                                        <div *ngFor="let q of defaultFeedbackQuestions; let i = index" @fadeIn class="text-sm text-slate-700 bg-slate-200/70 p-3 rounded-lg">
                                            <p class="font-semibold">{{i+1}}. {{q.text}}</p>
                                            <div class="flex flex-wrap gap-x-4 gap-y-2 mt-2 pl-4">
                                                <span *ngFor="let opt of q.options" class="px-2 py-0.5 text-xs bg-white border border-slate-300 rounded-full">{{opt}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h5 class="text-md font-semibold text-slate-800 pt-3 border-t border-slate-200/80">Additional Custom Questions</h5>
                                    <div class="space-y-4 mt-2">
                                        <div *ngFor="let question of newFeedback.customQuestions; let qIndex = index; trackBy: trackByFn" @slideFadeIn class="bg-white/80 border border-slate-300/80 rounded-lg p-4 space-y-3">
                                            <div class="flex items-center gap-2">
                                                <input type="text" [(ngModel)]="question.text" [name]="'customQuestionText' + qIndex" placeholder="Enter your custom question" class="flex-grow px-3 py-2 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                                                <button type="button" (click)="removeCustomQuestion(qIndex)" class="w-9 h-9 flex-shrink-0 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 flex items-center justify-center">
                                                    <i class="fa-solid fa-trash text-sm"></i>
                                                </button>
                                            </div>
                                            <div class="pl-4 space-y-2">
                                                <label class="text-xs font-semibold text-slate-500">Options</label>
                                                <div *ngFor="let option of question.options; let oIndex = index; trackBy: trackByFn" @slideFadeIn class="flex items-center gap-2">
                                                     <input type="text" [(ngModel)]="question.options[oIndex]" [name]="'customOption' + qIndex + '-' + oIndex" placeholder="Option {{oIndex + 1}}" class="flex-grow px-3 py-1.5 text-sm bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                                                     <button type="button" (click)="removeOption(qIndex, oIndex)" class="w-7 h-7 flex-shrink-0 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 flex items-center justify-center">
                                                         <i class="fa-solid fa-times text-xs"></i>
                                                     </button>
                                                </div>
                                                <button type="button" (click)="addOption(qIndex)" class="text-xs font-medium text-sky-600 hover:text-sky-800 transition-colors duration-200">
                                                    <i class="fa-solid fa-plus mr-1"></i> Add Option
                                                </button>
                                            </div>
                                        </div>
                                        <button type="button" (click)="addCustomQuestion()" class="w-full text-center py-2 text-sm font-medium text-sky-600 bg-sky-50 hover:bg-sky-100 border-2 border-dashed border-sky-200 rounded-lg transition-colors duration-200">
                                            <i class="fa-solid fa-plus mr-1"></i> Add a New Custom Question
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="flex items-center justify-end space-x-3 mt-6 pt-4 border-t border-slate-300/80">
                                <button (click)="setTrainerZoneView('overview')" class="px-4 py-2 text-slate-700 bg-slate-200 hover:bg-slate-300 font-semibold rounded-lg transition-colors duration-200">Cancel</button>
                                <button (click)="submitFeedback()" [disabled]="!newFeedback.trainingId" class="px-4 py-2 bg-rose-600 text-white rounded-lg font-medium hover:bg-rose-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all duration-200">Share Feedback</button>
                            </div>
                        </div>
                    </div>
                </div>

                 </div>
        </main>
    </div>
</div>

<div *ngIf="showSkillsModal" @fadeIn
    class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50">
    <div @modalScale class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl m-4" (click)="$event.stopPropagation()">
        <div class="flex items-center justify-between p-6 bg-slate-50 rounded-t-2xl border-b border-slate-200">
            <h3 class="text-xl font-bold text-slate-900">{{ modalTitle }} ({{ modalSkills.length > 0 ? modalSkills.length : (modalTitle === 'Skills Met' ? skillsMet : totalSkills) }})</h3>
            <button (click)="closeSkillsModal()" class="w-9 h-9 text-slate-400 hover:text-red-600 hover:bg-red-100 rounded-full flex items-center justify-center transition-colors">
                <i class="fa-solid fa-times text-lg"></i>
            </button>
        </div>
        <div class="max-h-[70vh] overflow-y-auto p-8">
            <div *ngIf="modalSkills.length > 0" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div *ngFor="let competency of modalSkills" @fadeIn
                    class="relative overflow-hidden bg-white p-6 rounded-2xl shadow-lg border border-slate-200/60"
                    [ngClass]="{
                           'border-t-4 border-green-500': competency.status === 'Met',
                           'border-t-4 border-orange-500': competency.status === 'Gap',
                           'border-t-4 border-red-500': competency.status === 'Error'
                       }">
                    <div class="flex flex-col justify-between h-full">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center space-x-4">
                                <div class="w-12 h-12 bg-sky-500 text-white rounded-lg flex items-center justify-center text-xl shadow-md">
                                    <i class="fa-solid fa-graduation-cap"></i>
                                </div>
                                <div>
                                    <h3 class="font-extrabold text-xl text-slate-900">{{ competency.skill }}</h3>
                                    <span class="text-sm font-medium text-slate-500">{{ competency.competency || 'Skill' }}</span>
                                </div>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wider" [ngClass]="{
                                   'bg-green-100 text-green-800': competency.status === 'Met',
                                   'bg-orange-100 text-orange-800': competency.status === 'Gap',
                                   'bg-red-100 text-red-800': competency.status === 'Error'
                               }">
                                {{ competency.status }}
                            </span>
                        </div>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center text-sm">
                                <div class="flex items-center text-slate-600">
                                    <i class="fa-solid fa-bullseye text-slate-400 mr-2 w-4 text-center"></i>Current: <span
                                        class="ml-1.5 font-semibold text-slate-900">{{ competency.current_expertise }}</span>
                                </div>
                                <div class="flex items-center text-slate-600">
                                    <i class="fa-solid fa-rocket text-slate-400 mr-2 w-4 text-center"></i>Target: <span
                                        class="ml-1.5 font-semibold text-slate-900">{{ competency.target_expertise }}</span>
                                </div>
                            </div>
                            <div class="w-full bg-slate-200 rounded-full h-3 overflow-hidden shadow-inner">
                                <div class="h-full rounded-full transition-all duration-700" [ngClass]="{
                                       'bg-gradient-to-r from-green-400 to-emerald-500': competency.status === 'Met',
                                       'bg-gradient-to-r from-orange-400 to-amber-500': competency.status === 'Gap',
                                       'bg-gradient-to-r from-red-400 to-rose-500': competency.status === 'Error'
                                   }" [style.width.%]="getSkillProgress(competency)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <p *ngIf="modalSkills.length === 0" class="text-center text-slate-500 py-8">No specific skill data to display. This modal shows skills assigned to you via the API.</p>
        </div>
    </div>
</div>

<div *ngIf="showScheduleTrainingModal" @fadeIn
  class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50">
  <div @modalScale class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl m-4" (click)="$event.stopPropagation()">
    <div class="flex items-center justify-between p-6 bg-slate-50 rounded-t-2xl border-b border-slate-200">
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 bg-sky-100 text-sky-600 rounded-lg flex items-center justify-center">
            <i class="fa-solid fa-calendar-plus text-2xl"></i>
        </div>
        <div>
            <h3 class="text-xl font-bold text-slate-900">Schedule a New Training</h3>
            <p class="text-sm text-slate-500">Create a new session for the training catalog.</p>
        </div>
      </div>
      <button (click)="closeScheduleTrainingModal()" class="w-9 h-9 text-slate-400 hover:text-red-600 hover:bg-red-100 rounded-full flex items-center justify-center transition-colors">
            <i class="fa-solid fa-times text-lg"></i>
        </button>
      </div>
    <form (ngSubmit)="scheduleTraining()" #trainingForm="ngForm" class="max-h-[75vh] overflow-y-auto p-8">
        <div class="space-y-8">
            <fieldset>
                <legend class="text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2 mb-4 w-full">Core Details</legend>
                <div class="space-y-5">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Training Name *</label>
                        <div class="relative">
                            <i class="fa-solid fa-laptop-code absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                            <input type="text" [(ngModel)]="newTraining.training_name" name="training_name" required placeholder="e.g., Advanced Python for Automation"
                            class="w-full pl-11 pr-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Topics Covered</label>
                        <div class="relative">
                            <i class="fa-solid fa-list-check absolute left-4 top-5 -translate-y-1/2 text-slate-400"></i>
                            <textarea [(ngModel)]="newTraining.training_topics" name="training_topics" rows="3" placeholder="List the main topics separated by commas..." class="w-full pl-11 pr-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition"></textarea>
                        </div>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend class="text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2 mb-4 w-full">Classification</legend>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-5">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Division</label>
                        <input type="text" [(ngModel)]="newTraining.division" name="division" placeholder="e.g., R&D" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Department</label>
                        <input type="text" [(ngModel)]="newTraining.department" name="department" placeholder="e.g., Software" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                    </div>
            <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Competency</label>
                        <input type="text" [(ngModel)]="newTraining.competency" name="competency" placeholder="e.g., Python" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
            </div>
                <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Skill</label>
                        <select [(ngModel)]="newTraining.skill" name="skill" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                            <option value="">Select Skill</option>
                    <option *ngFor="let name of skillNames" [value]="name">{{ name }}</option>
                </select>
                </div>
                <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Skill Category</label>
                        <select [(ngModel)]="newTraining.skill_category" name="skill_category" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                            <option *ngFor="let level of skillCategoryLevels" [value]="level">{{ level }}</option>
                        </select>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend class="text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2 mb-4 w-full">Trainer Information</legend>
                      <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Trainer Name *</label>
                        <div class="relative">
                            <i class="fa-solid fa-chalkboard-user absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                            <input type="text" [(ngModel)]="newTraining.trainer_name" name="trainer_name" required placeholder="Enter trainer's full name" class="w-full pl-11 pr-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                        </div>
                </div>
                <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Trainer Email</label>
                        <div class="relative">
                            <i class="fa-solid fa-envelope absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                            <input type="email" [(ngModel)]="newTraining.email" name="email" placeholder="Enter trainer's email" class="w-full pl-11 pr-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                        </div>
                </div>
                      </div>
            </fieldset>
            <fieldset>
                <legend class="text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2 mb-4 w-full">Logistics & Scheduling</legend>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-5">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Date *</label>
                        <input type="date" [(ngModel)]="newTraining.training_date" name="training_date" required class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Time</label>
                        <input type="time" [(ngModel)]="newTraining.time" name="time" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                    </div>
                <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Duration</label>
                        <input type="text" [(ngModel)]="newTraining.duration" name="duration" placeholder="e.g., 2 hours" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mt-5">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Training Type</label>
                        <select [(ngModel)]="newTraining.training_type" name="training_type" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                            <option>Online</option>
                            <option>In-Person</option>
                            <option>Hybrid</option>
                        </select>
                    </div>
                <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Available Seats</label>
                        <input type="text" [(ngModel)]="newTraining.seats" name="seats" placeholder="e.g., 25" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend class="text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2 mb-4 w-full">Additional Information</legend>
                <div class="space-y-5">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Prerequisites</label>
                        <input type="text" [(ngModel)]="newTraining.prerequisites" name="prerequisites" placeholder="e.g., Basic Python knowledge" class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition">
                    </div>
                <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Assessment Details</label>
                        <textarea [(ngModel)]="newTraining.assessment_details" name="assessment_details" rows="3" placeholder="Describe the assessment process, if any." class="w-full px-4 py-2.5 bg-white rounded-lg border border-slate-300 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition"></textarea>
                    </div>
                </div>
            </fieldset>
            </div>
        <div class="flex items-center justify-end space-x-4 pt-6 border-t border-slate-200 mt-8">
            <button type="button" (click)="closeScheduleTrainingModal()" class="px-6 py-2.5 font-semibold text-slate-600 hover:bg-slate-100 rounded-full transition-colors">Cancel</button>
            <button type="submit" [disabled]="trainingForm.invalid" class="px-7 py-2.5 bg-sky-600 text-white rounded-full font-semibold hover:bg-sky-700 disabled:bg-slate-400 disabled:cursor-not-allowed shadow-lg hover:shadow-sky-300 transition-all">
                <i class="fa-solid fa-check mr-2"></i> Schedule Training
                </button> </div>
        </form>
  </div>
</div>